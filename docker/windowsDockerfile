FROM meshrus/meshlib-windows:base

# Reset the shell.
SHELL ["cmd", "/S", "/C"]

# Install vcpkg requirements
WORKDIR "C:\\workspace\\vcpkg"
COPY ./thirdparty/vcpkg/triplets/x64-windows-meshrus.cmake ./triplets
COPY ./thirdparty/vcpkg/downloads  ./downloads
RUN C:\\workspace\\MeshLib\\thirdparty\\install.bat

WORKDIR "C:\\workspace"

# There is powershell on the server side.
ENTRYPOINT ["powershell.exe", "-NoLogo", "-ExecutionPolicy", "Bypass"]